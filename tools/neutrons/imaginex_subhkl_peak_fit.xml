<tool id="imaginex_subhkl_peak_fit" name="IMAGINE-X HKL Peak Finding"  profile="22.05" version="0.1.0-dev" python_template_version="3.5">
  <requirements>
    <container type="docker">ghcr.io/zjmorgan/subhkl:main</container>
  </requirements>
    <command detect_errors="exit_code"><![CDATA[

		mkdir out ; 

		#for $input in $inputs
			#if "." in $input.element_identifier
				#set $out_name = $input.element_identifier[0:-3] + "csv"
			#else
				#set $out_name = $input.element_identifier + ".csv"
			#end if
			
			python -m subhkl.io.parser finder $input out/$out_name ;
		#end for

    ]]></command>
    <inputs>
    
		<param format="tiff,png" multiple="true" name="inputs" type="data" label="Peak data file" />
		
    </inputs>
    <outputs>
		<collection name="output_data" type="list" label="Output Data">
		    <discover_datasets pattern="__designation__" ext="csv" directory="out/" />
		</collection>
    </outputs>
    <help><![CDATA[
        Calculates peak indices.
    ]]></help>
</tool>
