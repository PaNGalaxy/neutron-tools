<tool id="imaginex_subhkl_peak_index" name="IMAGINE-X HKL Peak Indexing"  profile="22.05" version="0.1.0-dev" python_template_version="3.5">
  <requirements>
    <container type="docker">ghcr.io/zjmorgan/subhkl:0.0.1</container>
  </requirements>
    <command detect_errors="exit_code"><![CDATA[

		mkdir out ; 

		#if unitCell.unitCell
			python /optimization.py $input out $wavelengthMin $wavelengthMax $unitCell.unitFile
		#else
			python /optimization.py $input out $wavelengthMin $wavelengthMax $unitCell.a $unitCell.b $unitCell.c $unitCell.alpha $unitCell.beta $unitCell.gamma
		#end for

    ]]></command>
    <inputs>
    
		<param format="h5" name="input" type="data" label="Peak data file" />
	    <param name="wavelengthMin" type="float" value="1.0" label="Min Wavelength" /> 
		<param name="wavelengthMax" type="float" value="3.5" label="Max Wavelength" /> 
		<conditional name="unitCell">
			<param name="unitCell" type="boolean" checked="true" label="Use unit cell file" help="Use a file to define a unit cell rather than constants."> 
			</param>
			<when value="true">
				<param name="unitFile" type="data" format="cif,pdb" label="Unit cell structure file" />
			</when>
			<when value="false">
				<param name="a" type="float" value="0.0" label="a" /> 
				<param name="b" type="float" value="0.0" label="b" /> 
				<param name="c" type="float" value="0.0" label="ac" /> 
				<param name="alpha" type="float" value="0.0" label="Alpha" /> 
				<param name="beta" type="float" value="0.0" label="Beta" /> 
				<param name="gamma" type="float" value="0.0" label="Gamma" /> 
			</when>
		</conditional>

    </inputs>
    <outputs>
		<data format="mtz" name="out/output" />
    </outputs>
    <help><![CDATA[
        Calculates peak indices in reciprocol space.
    ]]></help>
</tool>
