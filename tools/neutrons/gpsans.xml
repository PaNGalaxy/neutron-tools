<tool id="neutrons_gpsans" name="GPSANS"  profile="22.05" version="0.1.0">
  <description></description>
    <requirements>
        <container type="docker">code.ornl.gov:4567/ndip/tool-sources/sans-data-reduction/gpsans-reduction:0.1.0</container>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        mkdir reduced &&
        . /app/activate_env.sh &&
        ln -s $user_input /app/user_input.py &&
        ln -s $staff_input /app/staff_input.py &&
        python /app/gpsans.py -i $ipts_number -o reduced >$output 2>&1 ;
    ]]></command>
    <inputs>
        <param name="ipts_number" type="integer" optional="false" value="0" label="IPTS Number"/>
        <param name="user_input" type="data" format="py,txt" optional="false" label="User input"/>
        <param name="staff_input" type="data" format="py,txt" optional="false" label="Staff input"/>
    </inputs>
    <outputs>
        <collection type="list" name="output_collection1" label="GPSANS output">
            <discover_datasets format= "binary" pattern="__designation__" directory="reduced" />
        </collection>
        <collection type="list" name="output_collection2" label="GPSANS 1D ouptut">
            <discover_datasets pattern="__designation_and_ext__" directory="reduced/1D" />
        </collection>
        <collection type="list" name="output_collection3" label="GPSANS 2D ouptut">
            <discover_datasets pattern="__designation_and_ext__" directory="reduced/2D" />
        </collection>
        <data format="txt" name="output" label="GPSANS console output">
        </data>
    </outputs>
    <help><![CDATA[
        GPSANS data reduction tool
]]></help>
</tool>

