<tool id="neutrons_rpa_mrpapp" name="RPA simulation"  profile="22.05" version="0.1.0">
    <requirements>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    #set $image_tag = "0.1.0"
    mkdir results &&
    docker run
        --rm
        --init
        --mount type=bind,source=$params,target=/input/input.txt,readonly
        --mount type=bind,source=$tbparams,target=/input/tbparams.txt,readonly
        --mount type=bind,source=\$(pwd)/results,target=/output
            code.ornl.gov:4567/ndip/tool-sources/rpa/mrpapp:$image_tag
        $nproc &> $output
    ]]></command>
    <inputs>
        <param name="params" type="data" format="txt" optional="false" label="Simulation parameters"/>
        <param name="tbparams" type="data" format="txt" optional="false" label="TB parameters"/>
        <param name="nproc" type="integer" value="2" label="Number of processes"/>
    </inputs>
    <outputs>
        <data format="txt" name="output" label="RPA job output"/>
        <data format="txt" name="output_data" label="RPA simulation results">
            <discover_datasets pattern="chiRPA_demo.txt" directory="results"/>
        </data>
        <collection type="list" name="output_collection" label="All RPA output">
            <discover_datasets format="txt" pattern="__designation_and_ext__" directory="results" />
        </collection>
    </outputs>
    <help><![CDATA[
A tool to run simulations of neutron scattering and superconductivity in correlated electron systems using the MRPA++ code. It uses random-phase approximation (RPA) / Bardeen-Cooper-Schrieffer (BCS) theory to predict the neutron scattering cross section of realistic multi-orbital tight-binding models with Hubbard-like electron-electron interactions for the normal and superconducting states. It can also be used to calculate the pairing interaction in these models using an RPA approximation and to predict the superconducting gap structure.

The MRPA++ code has been developed with resources from the Center of Nanophase M aterials Sciences, which is a DOE Office of Science User Facility, and the NSF u nder DMR-1308603.
]]></help>
</tool>

